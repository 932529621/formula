<template>
  <div class="ticket_calendar">
    <div class="ticket_calendar_container">
      <div class="ticket_calendar_title_container">
        <div class="ticket_title">2023 FIA FORMULA ONE WORLD CHAMPIONSHIP</div>
        <div class="ticket_contact">
          <span class="contact_us">Need Help?</span>
          <div class="ticket_svg">
            <v-tooltip top :nudge-top="-12" color="rgb(51,51,51)">
              <template v-slot:activator="{ on, attrs }">
                <svg
                  v-bind="attrs"
                  v-on="on"
                  t="1667827602665"
                  class="phone"
                  viewBox="0 0 1024 1024"
                  version="1.1"
                  xmlns="http://www.w3.org/2000/svg"
                  p-id="5041"
                  width="28"
                  height="28"
                >
                  <path
                    d="M585.2 641.872c-8.256 7.648-20.048 20.72-35.04 38.992l-12.96 15.76-17.648-10.24c-84.352-49.008-152.384-121.216-190.832-204.928l-7.2-15.68 12.576-11.84c17.232-16.176 29.824-28.896 37.632-37.952a122.24 122.24 0 0 0 4.08-4.96 340.08 340.08 0 0 1-12.288-98.624 22.56 22.56 0 0 0-1.296-0.72 47.248 47.248 0 0 0-17.936-4.304l-99.424-3.472c-3.952-0.128-4.432 0.32-4.576 4.272-8.864 254 189.264 466.464 443.264 475.328 3.744 0.128 4.432-0.496 4.56-4.256l3.392-96.8c0.256-7.584 0.272-11.36-0.08-15.552-0.704-8.352-0.32-7.792-1.84-7.728-33.968 1.216-66.112-5.36-102.528-18.976a102.768 102.768 0 0 0-1.856 1.68z m-58.688-7.488c10.208-11.84 18.864-21.056 26.08-27.728 17.44-16.16 29.568-23.152 45.312-13.696 33.6 13.12 61.456 19.264 89.76 18.24 33.072-1.44 48.976 20.88 51.584 51.648 0.576 6.672 0.56 11.84 0.224 21.264l-3.376 96.8c-1.072 30.368-24.08 51.616-54.24 50.56-280.48-9.792-499.328-244.48-489.536-524.96 1.056-30.448 23.776-51.632 54.224-50.576l99.408 3.472c33.888 1.184 66.816 17.824 65.648 51.008a292.64 292.64 0 0 0 12.56 95.088c5.792 18.72-5.136 33.76-44.32 71.248 32.32 62.4 83.712 117.248 146.672 157.632z m18.16-312.24a190.08 190.08 0 0 1 107.36 53.952 190.08 190.08 0 0 1 54.672 112.672 10.576 10.576 0 0 1-10.4 11.808l-15.936 0.16a11.552 11.552 0 0 1-11.584-10.032 152.08 152.08 0 0 0-43.44-87.904 152.08 152.08 0 0 0-82.88-42.688 13.936 13.936 0 0 1-11.648-14.112l0.32-12.448a11.84 11.84 0 0 1 13.536-11.408z m2.704-114.08A304.16 304.16 0 0 1 732.144 296a304.16 304.16 0 0 1 88.688 193.312 9.344 9.344 0 0 1-9.216 10.032l-18.672 0.192a9.92 9.92 0 0 1-10-9.136 266.144 266.144 0 0 0-77.504-167.696 266.128 266.128 0 0 0-160.32-76.8 12.8 12.8 0 0 1-11.456-13.072l0.32-12.976a12.16 12.16 0 0 1 13.392-11.792z m-11.728 239.04c27.12 1.312 47.472 21.184 49.392 48.16 0.096 1.376-1.728 4.272-2.4 4.32-8.848 0.672-25.056 1.792-48.56 3.376h-0.112a4.4 4.4 0 0 1-4.688-4.816c1.664-23.808 2.784-40.224 3.392-49.248 0.032-0.496 2.048-1.84 2.976-1.792z"
                    p-id="5042"
                  ></path>
                </svg>
              </template>
              <span style="font-family: Heavy">+86 15980618073</span>
            </v-tooltip>
            <v-tooltip top :nudge-top="-12" color="rgb(51,51,51)">
              <template v-slot:activator="{ on, attrs }">
                <svg
                  v-bind="attrs"
                  v-on="on"
                  t="1667827012467"
                  class="mail"
                  viewBox="0 0 1024 1024"
                  version="1.1"
                  xmlns="http://www.w3.org/2000/svg"
                  p-id="2854"
                  width="28"
                  height="28"
                >
                  <path
                    d="M858.656 192 165.344 192C109.472 192 64 237.44 64 293.312l0 469.376C64 818.56 109.472 864 165.344 864l693.312 0C914.528 864 960 818.56 960 762.688L960 293.312C960 237.44 914.528 192 858.656 192zM858.656 800 165.344 800C144.736 800 128 783.264 128 762.688L128 293.312C128 272.736 144.736 256 165.344 256l684.544 0-307.488 279.808c-14.592 14.56-38.272 14.528-54.752-1.792l-244.256-206.752C229.856 315.84 209.664 317.504 198.272 331.008c-11.424 13.472-9.76 33.664 3.744 45.088l242.304 204.96c19.904 19.904 46.048 29.792 72.032 29.792 25.632 0 51.136-9.632 70.176-28.736L896 300.544l0 462.144C896 783.264 879.264 800 858.656 800z"
                    p-id="2855"
                  ></path>
                </svg>
              </template>
              <span style="font-family: Heavy">932529621@qq.com</span>
            </v-tooltip>
          </div>
        </div>
      </div>
      <div class="ticket_header_border"></div>
      <div class="ticket_table">
        <div
          class="ticket_prix ticket_grid"
          v-for="(item, index) in ticketInfo"
          :key="index"
        >
          <!--@click="
          $router.push({
            name: 'Ticketdetail',
            path: `/ticket/ticketdetail`,
            query: {
              teamId: ticketInfo[index].id,
              teamName: ticketInfo[index].team,
              driverOne:ticketInfo[index].driver_one,
              driverTwo:ticketInfo[index].driver_two,
            },
          })
        " -->
          <div class="ticket_prix_top">
            <img :src="ticketInfo[index].nation_banner_pic" />
          </div>
          <div class="ticket_prix_bottom">
            <div class="ticket_prix_img_container">
              <img :src="ticketInfo[index].nation_icon" alt="" />
            </div>
            <div class="ticket_prix_title_container">
              <div class="ticket_prix_title">
                {{ ticketInfo[index].prix_fullname }}
              </div>
              <div class="ticket_prix_subtitle">
                <span class="ticket_circuit">{{
                  ticketInfo[index].race_name
                }}</span>
                <span class="ticket_datetime">{{
                  ticketInfo[index].race_date
                }}</span>
              </div>
            </div>
            <div class="ticket_prix_price">
              <span>From </span>
              <span> {{ cheapestList[index].cheapest_price }}￥</span>
            </div>
            <v-btn
              color="rgb(255,6,0)"
              class="ticket_btn"
              @click.stop="
                $router.push({
                  name: 'Ticketdetail',
                  query: {
                    ticketId: ticketInfo[index].id,
                    prixName: ticketInfo[index].nation_name,
                  },
                })
              "
              >查看详细</v-btn
            >
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import { getcalendar,getcheapestinfo } from "@/plugins/http";
export default {
  data: () => ({
    ticketInfo: [],
    cheapestList:[]
  }),
  async mounted() {
    // this.$store.dispatch("ticket/getcheapestinfo", this.cheapestList);
    // this.isgetTicketInfo = true;
    const result = await getcheapestinfo();
    const res = await getcalendar();
    if (result.status === 200) {
      for (let key in result.data) {
        this.cheapestList.push(result.data[key]);
      }
    }
      if (res.status === 200) {
        res.data.schedules.forEach((item, index) => {
          this.ticketInfo.push(item);
        });
      this.$store.dispatch("ticket/getticketDetail", this.ticketInfo);
    }
  },

};
</script>

<style lang="scss" scoped>
.ticket_calendar {
  width: 100%;
  display: flex;
  justify-content: center;
  background-color: rgb(247, 244, 241);
  .ticket_calendar_container {
    width: 93%;
    height: 100%;
    margin-bottom: 50px;
    .ticket_calendar_title_container {
      width: 100%;
      padding: 30px 0px;
      display: flex;
      justify-content: space-between;
      .ticket_title {
        line-height: 30px;
        font-size: 1.5rem;
        font-family: Heavy;
        width: 70%;
      }
      .ticket_contact {
        width: 30%;
        display: flex;
        justify-content: flex-end;
        span {
          font-family: Heavy;
          font-size: 1.2rem;
          margin-right: 10%;
        }
      }
    }
    .ticket_header_border {
      width: 100%;
      height: 10px;
      background-color: #e10600;
    }
    .ticket_table {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      grid-template-rows: 1fr;
      gap: 10px;
      padding-top: 15px;
      .ticket_prix {
        height: 285px;
      }
      .ticket_grid {
        display: flex;
        flex-direction: column;
        .ticket_prix_top {
          width: 100%;
          height: 70%;
          transition: all 0.7s ease;
          img {
            width: 100%;
            height: 100%;
            object-fit: cover;
          }
        }
        .ticket_prix_bottom {
          width: 100%;
          height: 30%;
          display: flex;
          justify-content: center;
          align-items: center;
          border-bottom-right-radius: 15px;
          border-bottom-left-radius: 15px;
          background-color: white;
          transition: all 0.7s ease;
          .ticket_prix_img_container {
            width: 20%;
            display: flex;
            justify-content: center;

            img {
              width: 45px;
              height: 30px;
              border-radius: 5px;
              border: 1px solid black;
            }
          }

          .ticket_prix_title_container {
            width: 80%;
            .ticket_prix_title {
              font-size: 1rem;
              font-family: Heavy;
            }
            .ticket_prix_subtitle {
              span {
                font-size: 0.5rem;
                font-family: Lobster;
              }
              .ticket_datetime {
                margin-left: 15px;
              }
            }
          }
          .ticket_prix_price {
            display: none;
          }
          .ticket_prix_price span:nth-child(1) {
            font-size: 1.2rem;
          }
          .ticket_btn {
            color: white;
            display: none;
          }
        }
      }

      .ticket_grid:hover .ticket_prix_top {
        height: 0 !important;
      }
      .ticket_grid:hover .ticket_prix_bottom {
        height: 100% !important;
        background-color: black;
        flex-direction: column !important;
        text-align: center;
        .ticket_prix_title_container {
          width: auto !important;
        }
        .ticket_prix_title {
          color: white !important;
        }
        .ticket_prix_price {
          display: block !important;
          font-family: Heavy;
          font-size: 1.5rem;
          color: white;
          width: 70%;
          border-top: 1px solid white;
          border-bottom: 1px solid white;
        }
        .ticket_btn {
          display: block !important;
          margin-top: 10px;
        }
        .ticket_prix_subtitle {
          span {
            color: white !important;
          }
        }
      }
    }
    .ticket_table .ticket_prix:nth-child(1) {
      height: 570px;
      grid-row: 1/3;
      grid-column: 1/3;
      .ticket_prix_top {
        height: 80%;
      }
      .ticket_prix_bottom {
        height: 20%;
        .ticket_prix_title {
          font-size: 1.5rem !important;
        }
        .ticket_prix_subtitle {
          span {
            font-size: 0.8rem !important;
          }
        }
      }
    }
  }
}
</style>